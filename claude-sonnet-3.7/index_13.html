<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accessible Weather Dashboard - Current Conditions and Forecast</title>
    <style>
        /* Base Styles with Enhanced Accessibility */
        :root {
            --primary-color: #1a5f7a;
            --primary-dark: #0d3b4d;
            --secondary-color: #57c4e5;
            --accent-color: #ffb347;
            --text-color: #0a2533;
            --light-text: #ffffff;
            --background-color: #f5f9fc;
            --card-background: #ffffff;
            --error-color: #d32f2f;
            --success-color: #388e3c;
            --border-radius: 8px;
            --focus-outline: 3px solid #ffb347;
            --box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        /* Respect user's motion preferences */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.001ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.001ms !important;
                scroll-behavior: auto !important;
            }
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            padding: 0;
            margin: 0;
            min-height: 100vh;
        }

        /* Enhanced focus styles for all interactive elements */
        a:focus, button:focus, input:focus, select:focus, [tabindex]:focus {
            outline: var(--focus-outline);
            outline-offset: 2px;
            box-shadow: 0 0 0 2px #ffffff, 0 0 0 4px var(--accent-color);
            border-radius: var(--border-radius);
            z-index: 1;
        }

        /* Skip link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--accent-color);
            color: var(--text-color);
            padding: 8px;
            z-index: 100;
            font-weight: bold;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Layout */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background-color: var(--primary-color);
            color: var(--light-text);
            padding: 20px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            text-align: center;
        }

        main {
            padding: 30px 0;
        }

        /* Search Form */
        .search-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 600px;
            margin: 0 auto 30px;
            padding: 20px;
            background-color: var(--card-background);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-weight: bold;
            font-size: 1.1rem;
        }

        input[type="text"] {
            padding: 12px 16px;
            border: 2px solid #ccc;
            border-radius: var(--border-radius);
            font-size: 1rem;
            width: 100%;
        }

        .search-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .search-button:hover {
            background-color: var(--primary-dark);
        }

        .search-button:active {
            transform: translateY(1px);
        }

        .search-button svg {
            width: 20px;
            height: 20px;
        }

        .error-message {
            color: var(--error-color);
            font-weight: bold;
            padding: 10px;
            border-radius: var(--border-radius);
            background-color: rgba(211, 47, 47, 0.1);
            display: none;
        }

        .error-message.visible {
            display: block;
        }

        /* Weather Display */
        .weather-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .current-weather {
            background-color: var(--card-background);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            display: none;
        }

        .current-weather.visible {
            display: block;
        }

        .city-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .city-name {
            font-size: 1.8rem;
            margin: 0;
        }

        .current-date {
            font-size: 1.2rem;
            color: #555;
        }

        .weather-info {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            align-items: center;
        }

        .temperature-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .temperature {
            font-size: 3rem;
            font-weight: bold;
        }

        .weather-icon {
            width: 80px;
            height: 80px;
        }

        .weather-details {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .weather-condition {
            font-size: 1.4rem;
            font-weight: bold;
        }

        .weather-metrics {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }

        .metric {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: rgba(87, 196, 229, 0.1);
            padding: 10px 15px;
            border-radius: var(--border-radius);
        }

        .metric svg {
            width: 20px;
            height: 20px;
            fill: var(--primary-color);
        }

        /* Forecast Section */
        .forecast-section {
            display: none;
        }

        .forecast-section.visible {
            display: block;
        }

        .forecast-container {
            overflow-x: auto;
            padding: 10px 0;
            scrollbar-width: thin;
            scrollbar-color: var(--secondary-color) #eee;
        }

        .forecast-container::-webkit-scrollbar {
            height: 8px;
        }

        .forecast-container::-webkit-scrollbar-track {
            background: #eee;
            border-radius: 10px;
        }

        .forecast-container::-webkit-scrollbar-thumb {
            background-color: var(--secondary-color);
            border-radius: 10px;
        }

        .forecast-cards {
            display: flex;
            gap: 15px;
            padding: 10px 0;
            min-width: max-content;
        }

        .forecast-card {
            background-color: var(--card-background);
            border-radius: var(--border-radius);
            padding: 15px;
            min-width: 120px;
            box-shadow: var(--box-shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .forecast-time {
            font-weight: bold;
            color: var(--primary-color);
        }

        .forecast-icon {
            width: 50px;
            height: 50px;
        }

        .forecast-temp {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .forecast-condition {
            text-align: center;
            font-size: 0.9rem;
        }

        /* Loading Indicator */
        .loading {
            display: none;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
        }

        .loading.visible {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(87, 196, 229, 0.3);
            border-radius: 50%;
            border-top-color: var(--secondary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Status Messages */
        .status-message {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: var(--primary-color);
            color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            max-width: 300px;
            z-index: 1000;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s, transform 0.3s;
        }

        .status-message.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Footer */
        footer {
            background-color: var(--primary-color);
            color: var(--light-text);
            padding: 20px 0;
            margin-top: 40px;
        }

        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            text-align: center;
        }

        /* Responsive Design */
        @media (min-width: 768px) {
            .header-content {
                flex-direction: row;
                justify-content: space-between;
            }

            .search-form {
                flex-direction: row;
                align-items: flex-end;
            }

            .form-group {
                flex: 1;
            }

            .search-button {
                align-self: flex-end;
            }

            .city-header {
                flex-wrap: nowrap;
            }
        }

        /* High Contrast Mode */
        @media (forced-colors: active) {
            :root {
                --primary-color: CanvasText;
                --secondary-color: CanvasText;
                --accent-color: Highlight;
                --text-color: CanvasText;
                --light-text: Canvas;
                --background-color: Canvas;
                --card-background: Canvas;
                --box-shadow: none;
            }

            .search-button, .metric, .forecast-card {
                border: 1px solid CanvasText;
            }

            a:focus, button:focus, input:focus, select:focus {
                outline: 2px solid Highlight;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <header>
        <div class="container header-content">
            <h1>Weather Dashboard</h1>
        </div>
    </header>

    <main id="main-content">
        <div class="container">
            <section aria-labelledby="search-heading">
                <h2 id="search-heading" class="visually-hidden">Search for Weather</h2>
                
                <form id="search-form" class="search-form" aria-describedby="search-instructions">
                    <p id="search-instructions" class="visually-hidden">Enter a city name to get current weather and forecast information.</p>
                    
                    <div class="form-group">
                        <label for="city-input">Enter City Name:</label>
                        <input 
                            type="text" 
                            id="city-input" 
                            name="city" 
                            placeholder="e.g., New York, London, Tokyo" 
                            required 
                            aria-required="true"
                            autocomplete="address-level2"
                        >
                    </div>
                    
                    <button type="submit" class="search-button" aria-label="Search for weather">
                        <svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                        Search
                    </button>
                    
                    <div id="error-message" class="error-message" role="alert" aria-live="assertive"></div>
                </form>
            </section>

            <div id="loading" class="loading" aria-live="polite">
                <div class="spinner" aria-hidden="true"></div>
                <span class="visually-hidden">Loading weather data...</span>
            </div>

            <div class="weather-container">
                <section id="current-weather" class="current-weather" aria-labelledby="current-weather-heading">
                    <div class="city-header">
                        <h2 id="current-weather-heading" class="city-name"></h2>
                        <p class="current-date"></p>
                    </div>
                    
                    <div class="weather-info">
                        <div class="temperature-container">
                            <img id="weather-icon" class="weather-icon" src="" alt="">
                            <p class="temperature"><span id="temperature"></span>&deg;C</p>
                        </div>
                        
                        <div class="weather-details">
                            <p class="weather-condition" id="weather-condition"></p>
                            <p>Feels like: <span id="feels-like"></span>&deg;C</p>
                        </div>
                    </div>
                    
                    <div class="weather-metrics">
                        <div class="metric" aria-label="Humidity">
                            <svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path>
                            </svg>
                            <span>Humidity: <span id="humidity"></span>%</span>
                        </div>
                        
                        <div class="metric" aria-label="Wind Speed">
                            <svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"></path>
                            </svg>
                            <span>Wind: <span id="wind-speed"></span> km/h</span>
                        </div>
                        
                        <div class="metric" aria-label="Pressure">
                            <svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="8" x2="12" y2="12"></line>
                                <line x1="12" y1="16" x2="12.01" y2="16"></line>
                            </svg>
                            <span>Pressure: <span id="pressure"></span> hPa</span>
                        </div>
                        
                        <div class="metric" aria-label="Visibility">
                            <svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                            <span>Visibility: <span id="visibility"></span> km</span>
                        </div>
                    </div>
                </section>

                <section id="forecast-section" class="forecast-section" aria-labelledby="forecast-heading">
                    <h2 id="forecast-heading">24-Hour Forecast</h2>
                    
                    <div class="forecast-container">
                        <div id="forecast-cards" class="forecast-cards"></div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <div id="status-message" class="status-message" role="status" aria-live="polite"></div>

    <footer>
        <div class="container footer-content">
            <p>Weather Dashboard - Accessible Weather Information</p>
            <p>Data refreshed every hour. Last updated: <span id="last-updated"></span></p>
        </div>
    </footer>

    <script>
        // Helper functions for accessibility and UI management
        const helpers = {
            // Show error message with proper ARIA attributes
            showError: function(message) {
                const errorElement = document.getElementById('error-message');
                errorElement.textContent = message;
                errorElement.classList.add('visible');
                // Set focus to the error message for screen readers
                errorElement.focus();
                // Hide loading indicator
                this.setLoading(false);
            },
            
            // Clear error message
            clearError: function() {
                const errorElement = document.getElementById('error-message');
                errorElement.textContent = '';
                errorElement.classList.remove('visible');
            },
            
            // Show/hide loading indicator
            setLoading: function(isLoading) {
                const loadingElement = document.getElementById('loading');
                if (isLoading) {
                    loadingElement.classList.add('visible');
                    // Announce loading to screen readers
                    loadingElement.setAttribute('aria-label', 'Loading weather data. Please wait.');
                } else {
                    loadingElement.classList.remove('visible');
                    loadingElement.removeAttribute('aria-label');
                }
            },
            
            // Show status message
            showStatus: function(message, duration = 3000) {
                const statusElement = document.getElementById('status-message');
                statusElement.textContent = message;
                statusElement.classList.add('visible');
                
                setTimeout(() => {
                    statusElement.classList.remove('visible');
                }, duration);
            },
            
            // Format date for display
            formatDate: function(date) {
                const options = { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                };
                return new Date(date).toLocaleDateString('en-US', options);
            },
            
            // Format time for forecast display
            formatTime: function(timestamp) {
                const date = new Date(timestamp * 1000);
                return date.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: true 
                });
            },
            
            // Update last updated time
            updateLastUpdated: function() {
                const lastUpdatedElement = document.getElementById('last-updated');
                lastUpdatedElement.textContent = new Date().toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: true
                });
            },
            
            // Convert visibility from meters to kilometers
            formatVisibility: function(meters) {
                return (meters / 1000).toFixed(1);
            }
        };

        // Weather data handling
        const weatherApp = {
            apiKey: 'YOUR_API_KEY', // Replace with your actual API key
            
            // Fetch current weather data
            fetchCurrentWeather: async function(city) {
                try {
                    helpers.setLoading(true);
                    helpers.clearError();
                    
                    const response = await fetch(
                        `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${this.apiKey}`
                    );
                    
                    if (!response.ok) {
                        if (response.status === 404) {
                            throw new Error(`City "${city}" not found. Please check the spelling and try again.`);
                        } else {
                            throw new Error(`Weather data unavailable. Please try again later. (Error: ${response.status})`);
                        }
                    }
                    
                    const data = await response.json();
                    this.displayCurrentWeather(data);
                    
                    // After successfully getting current weather, fetch forecast
                    this.fetchForecast(data.coord.lat, data.coord.lon);
                    
                    // Update last updated time
                    helpers.updateLastUpdated();
                    
                    // Show success message
                    helpers.showStatus(`Weather data for ${data.name} loaded successfully`);
                    
                    return data;
                } catch (error) {
                    helpers.showError(error.message);
                    console.error('Error fetching weather:', error);
                }
            },
            
            // Fetch forecast data
            fetchForecast: async function(lat, lon) {
                try {
                    const response = await fetch(
                        `https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=metric&appid=${this.apiKey}`
                    );
                    
                    if (!response.ok) {
                        throw new Error(`Forecast data unavailable. Please try again later. (Error: ${response.status})`);
                    }
                    
                    const data = await response.json();
                    this.displayForecast(data);
                } catch (error) {
                    console.error('Error fetching forecast:', error);
                    // Don't show error for forecast - just log it
                } finally {
                    helpers.setLoading(false);
                }
            },
            
            // Display current weather data
            displayCurrentWeather: function(data) {
                const currentWeatherSection = document.getElementById('current-weather');
                
                // Update city name and date
                document.querySelector('.city-name').textContent = `${data.name}, ${data.sys.country}`;
                document.querySelector('.current-date').textContent = helpers.formatDate(new Date());
                
                // Update weather icon with proper alt text
                const weatherIcon = document.getElementById('weather-icon');
                weatherIcon.src = `https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png`;
                weatherIcon.alt = `Weather icon: ${data.weather[0].description}`;
                
                // Update temperature and condition
                document.getElementById('temperature').textContent = Math.round(data.main.temp);
                document.getElementById('weather-condition').textContent = data.weather[0].description;
                document.getElementById('feels-like').textContent = Math.round(data.main.feels_like);
                
                // Update metrics
                document.getElementById('humidity').textContent = data.main.humidity;
                document.getElementById('wind-speed').textContent = Math.round(data.wind.speed * 3.6); // Convert m/s to km/h
                document.getElementById('pressure').textContent = data.main.pressure;
                document.getElementById('visibility').textContent = helpers.formatVisibility(data.visibility);
                
                // Show the weather section
                currentWeatherSection.classList.add('visible');
                
                // Set focus to the current weather heading for screen readers
                document.getElementById('current-weather-heading').focus();
            },
            
            // Display forecast data
            displayForecast: function(data) {
                const forecastSection = document.getElementById('forecast-section');
                const forecastCards = document.getElementById('forecast-cards');
                
                // Clear previous forecast
                forecastCards.innerHTML = '';
                
                // Get next 8 forecast items (24 hours)
                const forecasts = data.list.slice(0, 8);
                
                // Create forecast cards
                forecasts.forEach((forecast, index) => {
                    const card = document.createElement('div');
                    card.className = 'forecast-card';
                    card.setAttribute('tabindex', '0'); // Make focusable for keyboard users
                    
                    const time = helpers.formatTime(forecast.dt);
                    const temp = Math.round(forecast.main.temp);
                    const description = forecast.weather[0].description;
                    const iconCode = forecast.weather[0].icon;
                    
                    card.innerHTML = `
                        <p class="forecast-time">${time}</p>
                        <img class="forecast-icon" src="https://openweathermap.org/img/wn/${iconCode}.png" 
                             alt="Weather icon: ${description}">
                        <p class="forecast-temp">${temp}&deg;C</p>
                        <p class="forecast-condition">${description}</p>
                    `;
                    
                    forecastCards.appendChild(card);
                });
                
                // Show the forecast section
                forecastSection.classList.add('visible');
            }
        };

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            const searchForm = document.getElementById('search-form');
            const cityInput = document.getElementById('city-input');
            
            // Form submission handler
            searchForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const city = cityInput.value.trim();
                if (!city) {
                    helpers.showError('Please enter a city name');
                    return;
                }
                
                weatherApp.fetchCurrentWeather(city);
            });
            
            // Add keyboard event listener for forecast cards navigation
            document.getElementById('forecast-cards').addEventListener('keydown', function(e) {
                if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
                    const cards = Array.from(this.querySelectorAll('.forecast-card'));
                    const currentIndex = cards.indexOf(document.activeElement);
                    
                    if (currentIndex !== -1) {
                        let newIndex;
                        
                        if (e.key === 'ArrowRight') {
                            newIndex = (currentIndex + 1) % cards.length;
                        } else {
                            newIndex = (currentIndex - 1 + cards.length) % cards.length;
                        }
                        
                        cards[newIndex].focus();
                    }
                }
            });
            
            // Check for stored city and load it
            const lastCity = localStorage.getItem('lastSearchedCity');
            if (lastCity) {
                cityInput.value = lastCity;
                weatherApp.fetchCurrentWeather(lastCity);
            }
            
            // Update last updated time on page load
            helpers.updateLastUpdated();
            
            // Add visually-hidden class for screen reader text
            const style = document.createElement('style');
            style.textContent = `
                .visually-hidden {
                    position: absolute;
                    width: 1px;
                    height: 1px;
                    margin: -1px;
                    padding: 0;
                    overflow: hidden;
                    clip: rect(0, 0, 0, 0);
                    white-space: nowrap;
                    border: 0;
                }
            `;
            document.head.appendChild(style);
        });

        // Save searched city to localStorage
        function saveLastSearchedCity(city) {
            localStorage.setItem('lastSearchedCity', city);
        }

        // Add event listener to save city on form submission
        document.getElementById('search-form').addEventListener('submit', function(e) {
            const city = document.getElementById('city-input').value.trim();
            if (city) {
                saveLastSearchedCity(city);
            }
        });
    </script>
</body>
</html>