<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Accessible Weather Dashboard – Search and 24-Hour Forecast</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Color and contrast checked for AAA compliance -->
  <style>
    :root {
      /* User-selectable color variables (AAA: 1.4.8) */
      --bg-color: #0a2240;
      --fg-color: #fff;
      --primary: #0059c1;
      --secondary: #ffb800;
      --accent: #d72660;
      --success: #218838;
      --error: #c1121f;
      --focus: #ffe500;
      --card-bg: #183661;
      --card-border: #ffe500;
      --nav-bg: #00284d;
      --nav-link: #fff;
      --nav-link-active: #ffe500;
      --nav-link-hover: #ffb800;
      --input-bg: #fff;
      --input-fg: #111;
      --input-border: #0059c1;
      --input-focus: #ffe500;
      --btn-bg: #0059c1;
      --btn-fg: #fff;
      --btn-hover: #183661;
      --btn-focus: #ffe500;
      --help-bg: #ffe500;
      --help-fg: #111;
      --error-bg: #c1121f;
      --error-fg: #fff;
      --status-bg: #218838;
      --status-fg: #fff;
      --breadcrumb-bg: #ffe500;
      --breadcrumb-fg: #0a2240;
      --forecast-bg: #183661;
      --forecast-border: #ffe500;
      --forecast-hour-bg: #00284d;
      --forecast-hour-fg: #fff;
      --forecast-hour-border: #ffb800;
      --shadow: 0 2px 12px rgba(0,0,0,0.15);
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg-color: #091b33;
        --fg-color: #fff;
        --input-bg: #13294b;
        --input-fg: #fff;
      }
    }

    html {
      background: var(--bg-color);
      color: var(--fg-color);
      font-family: 'Segoe UI', Arial, sans-serif;
      font-size: 1.125rem;
      line-height: 1.6;
      scroll-behavior: smooth;
      /* AAA: 200% zoom and no horizontal scroll */
      max-width: 100vw;
      overflow-x: hidden;
    }

    body {
      margin: 0;
      padding: 0;
      background: var(--bg-color);
      color: var(--fg-color);
      min-height: 100vh;
      /* AAA: Paragraph spacing at least 1.5x line spacing */
      letter-spacing: 0.01em;
    }

    /* Skip link styles */
    .skip-link {
      position: absolute;
      left: 8px;
      top: 8px;
      background: var(--focus);
      color: #111;
      padding: 0.5em 1em;
      z-index: 1000;
      border-radius: 6px;
      font-weight: bold;
      text-decoration: none;
      box-shadow: var(--shadow);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s;
    }
    .skip-link:focus {
      opacity: 1;
      pointer-events: auto;
      outline: 4px solid var(--accent);
    }

    /* Layout grid */
    .container {
      display: grid;
      grid-template-columns: 1fr 320px;
      gap: 2rem;
      max-width: 1100px;
      margin: 0 auto;
      padding: 2rem 1rem 2rem 1rem;
    }
    @media (max-width: 900px) {
      .container {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
    }

    header {
      background: linear-gradient(90deg, var(--primary) 60%, var(--accent) 100%);
      color: var(--fg-color);
      padding: 1.5rem 1rem 1rem 1rem;
      box-shadow: var(--shadow);
      border-bottom: 6px solid var(--secondary);
    }
    header h1 {
      margin: 0 0 0.5em 0;
      font-size: 2.2rem;
      letter-spacing: 0.02em;
      text-shadow: 1px 2px 0 #00284d;
    }
    header p {
      margin: 0;
      font-size: 1.2rem;
      color: #ffe500;
      text-shadow: 1px 1px 0 #00284d;
    }

    nav[aria-label] {
      background: var(--nav-bg);
      color: var(--nav-link);
      padding: 0.5rem 0;
      box-shadow: var(--shadow);
      border-bottom: 3px solid var(--accent);
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }
    .nav-list {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      list-style: none;
      margin: 0;
      padding: 0 1rem;
    }
    .nav-list li {
      position: relative;
    }
    .nav-list a, .nav-list button {
      color: var(--nav-link);
      background: none;
      border: none;
      font: inherit;
      padding: 0.75em 1.2em;
      border-radius: 8px;
      text-decoration: none;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      min-width: 44px;
      min-height: 44px;
      display: inline-block;
      position: relative;
    }
    .nav-list a:focus, .nav-list button:focus {
      outline: 4px solid var(--focus);
      background: var(--nav-link-hover);
      color: #111;
      z-index: 2;
    }
    .nav-list a[aria-current="page"], .nav-list .active {
      background: var(--nav-link-active);
      color: #0a2240;
      font-weight: bold;
      box-shadow: 0 0 0 2px var(--accent);
    }
    .nav-list a:hover, .nav-list button:hover {
      background: var(--nav-link-hover);
      color: #111;
    }

    /* Breadcrumbs */
    nav[aria-label="Breadcrumb"] {
      background: var(--breadcrumb-bg);
      color: var(--breadcrumb-fg);
      padding: 0.5em 1em;
      margin-bottom: 1.5rem;
      border-radius: 8px;
      font-size: 1rem;
      box-shadow: var(--shadow);
    }
    .breadcrumb-list {
      list-style: none;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5em;
      margin: 0;
      padding: 0;
    }
    .breadcrumb-list li:not(:last-child)::after {
      content: "›";
      margin: 0 0.5em;
      color: var(--primary);
      font-weight: bold;
    }
    .breadcrumb-list a {
      color: var(--primary);
      text-decoration: underline;
      font-weight: 500;
    }
    .breadcrumb-list a:focus {
      outline: 3px solid var(--accent);
      background: var(--nav-link-hover);
      color: #111;
    }
    .breadcrumb-list .current {
      font-weight: bold;
      color: var(--accent);
      text-decoration: none;
      cursor: default;
    }

    /* Main content */
    main {
      outline: none;
    }

    .search-section {
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 2rem 2rem 1.5rem 2rem;
      border: 3px solid var(--card-border);
      margin-bottom: 2rem;
    }
    .search-section h2 {
      margin-top: 0;
      font-size: 1.5rem;
      color: var(--secondary);
      text-shadow: 1px 1px 0 #00284d;
    }
    .search-form {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
      margin-top: 1rem;
    }
    .search-form fieldset {
      border: none;
      padding: 0;
      margin: 0;
    }
    .search-form label {
      font-weight: 600;
      margin-bottom: 0.5em;
      display: block;
      color: var(--fg-color);
      letter-spacing: 0.01em;
    }
    .search-form input[type="text"] {
      width: 100%;
      max-width: 350px;
      padding: 0.8em 1em;
      font-size: 1.1rem;
      border-radius: 8px;
      border: 2px solid var(--input-border);
      background: var(--input-bg);
      color: var(--input-fg);
      transition: border 0.2s;
      min-height: 44px;
      min-width: 44px;
      box-sizing: border-box;
      margin-bottom: 0.25em;
    }
    .search-form input[type="text"]:focus {
      border-color: var(--input-focus);
      outline: 4px solid var(--focus);
      background: #fffbe7;
      color: #111;
    }
    .required-indicator {
      color: var(--accent);
      font-weight: bold;
      margin-left: 0.2em;
    }
    .help-text {
      background: var(--help-bg);
      color: var(--help-fg);
      border-radius: 6px;
      padding: 0.5em 1em;
      font-size: 1rem;
      margin-top: 0.3em;
      box-shadow: var(--shadow);
      display: inline-block;
      max-width: 80ch;
    }
    .search-form button[type="submit"] {
      background: var(--btn-bg);
      color: var(--btn-fg);
      border: none;
      border-radius: 8px;
      padding: 0.9em 2.2em;
      font-size: 1.15rem;
      font-weight: 600;
      box-shadow: var(--shadow);
      cursor: pointer;
      min-width: 44px;
      min-height: 44px;
      transition: background 0.2s, color 0.2s;
      outline: none;
      margin-top: 0.2em;
      letter-spacing: 0.03em;
      position: relative;
    }
    .search-form button[type="submit"]:focus {
      outline: 4px solid var(--btn-focus);
      background: var(--btn-hover);
      color: #ffe500;
      z-index: 1;
    }
    .search-form button[type="submit"]:hover {
      background: var(--btn-hover);
      color: #ffe500;
    }
    .error-message {
      background: var(--error-bg);
      color: var(--error-fg);
      border-radius: 6px;
      padding: 0.7em 1em;
      font-size: 1.05rem;
      margin-top: 0.7em;
      margin-bottom: 0.7em;
      box-shadow: var(--shadow);
      border: 2px solid #960c13;
      display: block;
      max-width: 80ch;
    }
    .status-message {
      background: var(--status-bg);
      color: var(--status-fg);
      border-radius: 6px;
      padding: 0.7em 1em;
      font-size: 1.05rem;
      margin-top: 0.7em;
      margin-bottom: 0.7em;
      box-shadow: var(--shadow);
      border: 2px solid #155724;
      display: block;
      max-width: 80ch;
    }

    /* Weather cards */
    .weather-section {
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 2rem 2rem 1.5rem 2rem;
      border: 3px solid var(--card-border);
      margin-bottom: 2rem;
      min-width: 0;
    }
    .weather-section h2 {
      color: var(--secondary);
      font-size: 1.35rem;
      margin-top: 0;
      text-shadow: 1px 1px 0 #00284d;
    }
    .current-weather {
      display: flex;
      align-items: flex-start;
      gap: 2rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }
    .weather-icon {
      width: 90px;
      height: 90px;
      min-width: 90px;
      min-height: 90px;
      border-radius: 50%;
      background: var(--forecast-hour-bg);
      border: 3px solid var(--forecast-hour-border);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow);
      margin-right: 1rem;
    }
    .weather-info {
      flex: 1 1 200px;
      min-width: 200px;
    }
    .weather-info h3 {
      margin: 0 0 0.4em 0;
      font-size: 1.15rem;
      color: var(--accent);
    }
    .temperature {
      font-size: 2.6rem;
      font-weight: bold;
      color: var(--secondary);
      margin: 0 0 0.1em 0;
      letter-spacing: 0.02em;
      line-height: 1.2;
    }
    .condition {
      font-size: 1.2rem;
      color: var(--fg-color);
      margin: 0 0 0.5em 0;
    }
    .meta {
      font-size: 1rem;
      color: #ffe500;
      margin: 0 0 0.2em 0;
    }
    .visually-hidden {
      position: absolute !important;
      height: 1px; width: 1px;
      overflow: hidden;
      clip: rect(1px,1px,1px,1px);
      white-space: nowrap;
      border: 0;
      padding: 0;
      margin: 0;
    }

    /* 24-hour forecast */
    .forecast-section {
      margin-top: 2rem;
    }
    .forecast-section h2 {
      color: var(--secondary);
      font-size: 1.25rem;
      margin-bottom: 1rem;
      text-shadow: 1px 1px 0 #00284d;
    }
    .forecast-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
      gap: 1.2rem;
      background: var(--forecast-bg);
      border-radius: 10px;
      padding: 1.2rem 1rem;
      border: 2px solid var(--forecast-border);
      box-shadow: var(--shadow);
      overflow-x: auto;
      max-width: 100vw;
    }
    .forecast-hour {
      background: var(--forecast-hour-bg);
      color: var(--forecast-hour-fg);
      border: 2px solid var(--forecast-hour-border);
      border-radius: 10px;
      padding: 1em 0.5em;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 120px;
      min-height: 150px;
      box-shadow: var(--shadow);
      position: relative;
      font-size: 1rem;
    }
    .forecast-hour .hour {
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 0.5em;
      color: var(--secondary);
    }
    .forecast-hour .forecast-temp {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--accent);
      margin-bottom: 0.2em;
    }
    .forecast-hour .forecast-icon {
      width: 48px;
      height: 48px;
      margin-bottom: 0.3em;
      border-radius: 50%;
      background: #fffbe7;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid var(--forecast-hour-border);
    }
    .forecast-hour .forecast-desc {
      font-size: 0.98rem;
      color: var(--fg-color);
      text-align: center;
      margin-top: 0.1em;
    }

    /* Sidebar: multiple ways, help, preferences */
    aside {
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 1.7rem 1.5rem 1.5rem 1.5rem;
      border: 3px solid var(--card-border);
      min-width: 0;
    }
    aside h2 {
      color: var(--secondary);
      font-size: 1.2rem;
      margin-top: 0;
      margin-bottom: 0.8em;
      text-shadow: 1px 1px 0 #00284d;
    }
    .sidebar-section {
      margin-bottom: 1.5em;
    }
    .sidebar-section:last-child {
      margin-bottom: 0;
    }
    .sidebar-list {
      list-style: disc inside;
      margin: 0 0 0.5em 0;
      padding: 0 0 0 1em;
    }
    .sidebar-list li {
      margin-bottom: 0.6em;
      line-height: 1.5;
    }
    .sidebar-link {
      color: var(--secondary);
      text-decoration: underline;
      font-weight: 500;
    }
    .sidebar-link:focus {
      outline: 3px solid var(--accent);
      background: var(--nav-link-hover);
      color: #111;
    }
    .color-controls label {
      display: block;
      margin-bottom: 0.3em;
      font-size: 1rem;
      font-weight: 600;
      color: var(--secondary);
    }
    .color-controls input[type="color"] {
      width: 44px;
      height: 44px;
      border: 2px solid var(--accent);
      border-radius: 8px;
      margin-right: 0.6em;
      cursor: pointer;
      vertical-align: middle;
    }
    .color-controls input[type="color"]:focus {
      outline: 3px solid var(--focus);
      border-color: var(--focus);
    }
    .color-controls {
      margin-bottom: 1em;
    }

    /* Focus indicators AAA */
    :focus {
      outline: 4px solid var(--focus);
      outline-offset: 2px;
    }

    /* Responsive design */
    @media (max-width: 700px) {
      .container {
        padding: 1rem 0.2rem;
      }
      .search-section, .weather-section, aside {
        padding: 1.2rem 0.7rem;
      }
      .forecast-grid {
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 0.7rem;
        padding: 0.7rem 0.2rem;
      }
    }

    /* Text presentation AAA */
    p, li, .help-text, .error-message, .status-message {
      line-height: 1.6;
      margin-bottom: 1.5em;
      max-width: 80ch;
      text-align: left;
    }
    h1, h2, h3, h4, h5, h6 {
      line-height: 1.35;
      margin-bottom: 0.7em;
      font-weight: bold;
      max-width: 80ch;
      text-align: left;
    }

    /* Footer */
    footer {
      background: var(--nav-bg);
      color: var(--nav-link);
      text-align: center;
      padding: 1.2rem 1rem 1.5rem 1rem;
      font-size: 1rem;
      margin-top: 2rem;
      border-top: 3px solid var(--accent);
      letter-spacing: 0.01em;
    }
    .footer-links {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5em;
      justify-content: center;
      margin: 1em 0 0.5em 0;
      padding: 0;
      list-style: none;
    }
    .footer-links a {
      color: var(--secondary);
      text-decoration: underline;
      font-weight: 500;
    }
    .footer-links a:focus {
      outline: 3px solid var(--accent);
      background: var(--nav-link-hover);
      color: #111;
    }

    /* Loading spinner (accessible) */
    .spinner {
      width: 48px;
      height: 48px;
      border: 6px solid #ffe500;
      border-top: 6px solid var(--primary);
      border-radius: 50%;
      animation: spin 1.2s linear infinite;
      margin: 1em auto;
      display: block;
    }
    @media (prefers-reduced-motion: reduce) {
      .spinner {
        animation: none;
      }
    }
    @keyframes spin {
      0% { transform: rotate(0deg);}
      100% { transform: rotate(360deg);}
    }

    /* Icon alternative for color-only elements */
    .icon-indicator {
      display: inline-block;
      width: 1.3em;
      height: 1.3em;
      vertical-align: middle;
      margin-right: 0.2em;
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <header>
    <h1 id="page-title">Accessible Weather Dashboard</h1>
    <p>Your inclusive, colorful, and fully accessible way to check the weather anywhere in the world.</p>
  </header>
  <nav aria-label="Main navigation">
    <ul class="nav-list" role="menubar">
      <li role="none">
        <a href="#main-content" role="menuitem" aria-current="page" tabindex="0">Weather Dashboard</a>
      </li>
      <li role="none">
        <a href="#sitemap" role="menuitem" tabindex="0">Sitemap</a>
      </li>
      <li role="none">
        <a href="#help" role="menuitem" tabindex="0">Help</a>
      </li>
      <li role="none">
        <a href="#preferences" role="menuitem" tabindex="0">Preferences</a>
      </li>
    </ul>
  </nav>
  <nav aria-label="Breadcrumb">
    <ol class="breadcrumb-list">
      <li><a href="#main-content">Home</a></li>
      <li><span class="current" aria-current="page">Weather Dashboard</span></li>
    </ol>
  </nav>
  <div class="container">
    <main id="main-content" tabindex="-1">
      <section class="search-section" aria-labelledby="search-heading">
        <h2 id="search-heading">Search for a City</h2>
        <form class="search-form" id="weather-search-form" autocomplete="off" novalidate aria-describedby="search-help" aria-labelledby="search-heading">
          <fieldset>
            <legend class="visually-hidden">Enter city name to get weather</legend>
            <label for="city-input">
              City Name
              <span class="required-indicator" aria-hidden="true">*</span>
            </label>
            <input
              type="text"
              id="city-input"
              name="city"
              inputmode="text"
              aria-required="true"
              required
              minlength="2"
              maxlength="64"
              aria-describedby="search-help city-input-error"
              autocomplete="address-level2"
              spellcheck="true"
              aria-label="Enter city name"
              placeholder="e.g., London, Tokyo, New York"
              style="max-width: 350px;"
            >
            <div id="search-help" class="help-text">
              Please enter the name of the city you want to check the weather for. For best results, include the country if the city is not unique (e.g., Paris, France).
            </div>
            <div id="city-input-error" class="error-message" role="alert" aria-live="assertive" style="display:none;"></div>
          </fieldset>
          <button type="submit" id="search-btn" aria-label="Search for weather in the entered city">
            <span class="icon-indicator" aria-hidden="true">🔍</span>
            Search Weather
          </button>
        </form>
        <div id="form-status" role="status" aria-live="polite" class="status-message" style="display:none;"></div>
      </section>

      <section class="weather-section" aria-labelledby="current-weather-heading" style="display:none;">
        <h2 id="current-weather-heading">Current Weather</h2>
        <div class="current-weather" id="current-weather" aria-live="polite"></div>
      </section>

      <section class="weather-section forecast-section" aria-labelledby="forecast-heading" style="display:none;">
        <h2 id="forecast-heading">24-Hour Forecast</h2>
        <div class="forecast-grid" id="forecast-grid" aria-describedby="forecast-desc"></div>
        <div id="forecast-desc" class="visually-hidden">
          The following table displays the hourly forecast for the next 24 hours including time, temperature, weather icon, and condition.
        </div>
      </section>
      <section id="sitemap" aria-labelledby="sitemap-heading" style="margin-top:2rem;">
        <h2 id="sitemap-heading">Sitemap</h2>
        <ul>
          <li><a href="#main-content">Weather Dashboard</a></li>
          <li><a href="#sitemap">Sitemap</a></li>
          <li><a href="#help">Help &amp; Accessibility</a></li>
          <li><a href="#preferences">Preferences</a></li>
        </ul>
      </section>
      <section id="help" aria-labelledby="help-heading" style="margin-top:2rem;">
        <h2 id="help-heading">Help &amp; Accessibility</h2>
        <p>
          <strong>How to use:</strong> Enter the name of a city and press "Search Weather". The dashboard will show current weather and a 24-hour forecast.
        </p>
        <p>
          <strong>Keyboard navigation:</strong> All elements are accessible via keyboard. Use Tab/Shift+Tab to move between fields and Enter/Space to activate buttons.
        </p>
        <p>
          <strong>Accessibility features:</strong> This site meets <abbr title="Web Content Accessibility Guidelines">WCAG</abbr> 2.2 <abbr title="Triple A">AAA</abbr> standards, including enhanced contrast, semantic structure, alternative text, ARIA live regions, and robust keyboard support.
        </p>
        <p>
          <strong>Color customization:</strong> Use the "Preferences" panel to select foreground and background colors for optimal readability.
        </p>
        <p>
          <strong>Unusual words:</strong> <abbr title="Application Programming Interface">API</abbr> (a way for computers to talk to each other), <abbr title="Degrees Celsius">°C</abbr> (temperature unit).
        </p>
        <p>
          <strong>Abbreviations:</strong> <abbr title="Degrees Celsius">°C</abbr> (degrees Celsius), <abbr title="Degrees Fahrenheit">°F</abbr> (degrees Fahrenheit), <abbr title="Percent">%</abbr> (percent).
        </p>
        <p>
          <strong>Reading level:</strong> This content is written for a lower secondary education level.
        </p>
        <p>
          <strong>Context-sensitive help:</strong> Help icons and instructions are available near all form fields.
        </p>
        <p>
          <strong>Pronunciation:</strong> "Celsius" is pronounced as "SELL-see-us".
        </p>
      </section>
      <section id="preferences" aria-labelledby="preferences-heading" style="margin-top:2rem;">
        <h2 id="preferences-heading">Preferences</h2>
        <form class="color-controls" aria-describedby="color-controls-help">
          <label for="fg-color-picker">
            Foreground (Text) Color
            <input type="color" id="fg-color-picker" name="fg-color-picker" aria-label="Select foreground color" value="#ffffff">
          </label>
          <label for="bg-color-picker">
            Background Color
            <input type="color" id="bg-color-picker" name="bg-color-picker" aria-label="Select background color" value="#0a2240">
          </label>
          <div id="color-controls-help" class="help-text">
            Choose colors for text and background to maximize readability. Default values meet AAA contrast requirements.
          </div>
        </form>
      </section>
    </main>
    <aside aria-labelledby="sidebar-heading">
      <h2 id="sidebar-heading">Quick Access &amp; Help</h2>
      <section class="sidebar-section" aria-labelledby="sidebar-search-heading">
        <h3 id="sidebar-search-heading">Find Weather Fast</h3>
        <ul class="sidebar-list">
          <li>
            <a class="sidebar-link" href="#search-heading">Go to Search</a>
          </li>
          <li>
            <a class="sidebar-link" href="#current-weather-heading">Current Weather</a>
          </li>
          <li>
            <a class="sidebar-link" href="#forecast-heading">24-Hour Forecast</a>
          </li>
        </ul>
      </section>
      <section class="sidebar-section" aria-labelledby="sidebar-help-heading">
        <h3 id="sidebar-help-heading">Help &amp; Definitions</h3>
        <ul class="sidebar-list">
          <li>
            <span class="icon-indicator" aria-hidden="true">❓</span>
            <strong>City:</strong> The name of the place you want weather for.
          </li>
          <li>
            <span class="icon-indicator" aria-hidden="true">🌡️</span>
            <strong>Temperature:</strong> How hot or cold it is, in <abbr title="Degrees Celsius">°C</abbr>.
          </li>
          <li>
            <span class="icon-indicator" aria-hidden="true">💧</span>
            <strong>Humidity:</strong> How much water is in the air, in <abbr title="Percent">%</abbr>.
          </li>
          <li>
            <span class="icon-indicator" aria-hidden="true">💨</span>
            <strong>Wind:</strong> How fast the air is moving, in meters per second (<abbr title="Meters per second">m/s</abbr>).
          </li>
        </ul>
      </section>
      <section class="sidebar-section" aria-labelledby="sidebar-preferences-heading">
        <h3 id="sidebar-preferences-heading">Accessibility Preferences</h3>
        <ul class="sidebar-list">
          <li>
            <a class="sidebar-link" href="#preferences-heading">Change Colors</a>
          </li>
          <li>
            <button type="button" id="reset-colors-btn" class="sidebar-link" style="background:none;border:none;padding:0;" aria-label="Reset colors to default">
              Reset Colors
            </button>
          </li>
        </ul>
      </section>
    </aside>
  </div>
  <footer>
    <nav aria-label="Footer navigation">
      <ul class="footer-links">
        <li><a href="#main-content">Weather Dashboard</a></li>
        <li><a href="#sitemap">Sitemap</a></li>
        <li><a href="#help">Help &amp; Accessibility</a></li>
        <li><a href="#preferences">Preferences</a></li>
      </ul>
    </nav>
    <div>
      <strong>Accessible Weather Dashboard</strong> – All rights reserved. <br>
      <span>Designed for <abbr title="Web Content Accessibility Guidelines">WCAG</abbr> 2.2 <abbr title="Triple A">AAA</abbr> compliance.</span>
    </div>
  </footer>
  <script>
    // Accessibility: focus management for skip link
    document.querySelector('.skip-link').addEventListener('click', function(e) {
      setTimeout(function() {
        document.getElementById('main-content').focus();
      }, 50);
    });

    // User-selectable colors (AAA: 1.4.8)
    const fgPicker = document.getElementById('fg-color-picker');
    const bgPicker = document.getElementById('bg-color-picker');
    const resetColorsBtn = document.getElementById('reset-colors-btn');
    function setColorsFromPickers() {
      document.documentElement.style.setProperty('--fg-color', fgPicker.value);
      document.documentElement.style.setProperty('--bg-color', bgPicker.value);
    }
    fgPicker.addEventListener('input', setColorsFromPickers);
    bgPicker.addEventListener('input', setColorsFromPickers);
    resetColorsBtn.addEventListener('click', function() {
      fgPicker.value = '#ffffff';
      bgPicker.value = '#0a2240';
      setColorsFromPickers();
      fgPicker.focus();
    });

    // Weather API interaction (Open-Meteo + geocoding)
    // For demonstration, fallback to static data if API fails
    const form = document.getElementById('weather-search-form');
    const cityInput = document.getElementById('city-input');
    const cityError = document.getElementById('city-input-error');
    const formStatus = document.getElementById('form-status');
    const currentWeatherSection = document.querySelector('.weather-section');
    const forecastSection = document.querySelector('.forecast-section');
    const currentWeatherDiv = document.getElementById('current-weather');
    const forecastGrid = document.getElementById('forecast-grid');

    // Accessibility: focus management for error messages
    function showError(message) {
      cityError.textContent = message;
      cityError.style.display = 'block';
      cityInput.setAttribute('aria-invalid', 'true');
      cityInput.focus();
    }
    function clearError() {
      cityError.textContent = '';
      cityError.style.display = 'none';
      cityInput.removeAttribute('aria-invalid');
    }
    function showStatus(message) {
      formStatus.textContent = message;
      formStatus.style.display = 'block';
    }
    function clearStatus() {
      formStatus.textContent = '';
      formStatus.style.display = 'none';
    }

    // Loading spinner (accessible)
    function showLoading() {
      showStatus('Loading weather data...');
      formStatus.innerHTML = '<span class="spinner" aria-label="Loading" role="status"></span> Loading weather data...';
    }

    // Helper: Map weather codes to icons/descriptions (Open-Meteo)
    const weatherIcons = {
      0: { icon: '☀️', desc: 'Clear sky' },
      1: { icon: '🌤️', desc: 'Mainly clear' },
      2: { icon: '⛅', desc: 'Partly cloudy' },
      3: { icon: '☁️', desc: 'Overcast' },
      45: { icon: '🌫️', desc: 'Fog' },
      48: { icon: '🌫️', desc: 'Depositing rime fog' },
      51: { icon: '🌦️', desc: 'Light drizzle' },
      53: { icon: '🌦️', desc: 'Moderate drizzle' },
      55: { icon: '🌦️', desc: 'Dense drizzle' },
      56: { icon: '🌧️', desc: 'Light freezing drizzle' },
      57: { icon: '🌧️', desc: 'Dense freezing drizzle' },
      61: { icon: '🌧️', desc: 'Slight rain' },
      63: { icon: '🌧️', desc: 'Moderate rain' },
      65: { icon: '🌧️', desc: 'Heavy rain' },
      66: { icon: '🌧️', desc: 'Light freezing rain' },
      67: { icon: '🌧️', desc: 'Heavy freezing rain' },
      71: { icon: '🌨️', desc: 'Slight snow fall' },
      73: { icon: '🌨️', desc: 'Moderate snow fall' },
      75: { icon: '🌨️', desc: 'Heavy snow fall' },
      77: { icon: '🌨️', desc: 'Snow grains' },
      80: { icon: '🌦️', desc: 'Slight rain showers' },
      81: { icon: '🌦️', desc: 'Moderate rain showers' },
      82: { icon: '🌦️', desc: 'Violent rain showers' },
      85: { icon: '🌨️', desc: 'Slight snow showers' },
      86: { icon: '🌨️', desc: 'Heavy snow showers' },
      95: { icon: '⛈️', desc: 'Thunderstorm' },
      96: { icon: '⛈️', desc: 'Thunderstorm with slight hail' },
      99: { icon: '⛈️', desc: 'Thunderstorm with heavy hail' }
    };

    // Form validation
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      clearError();
      clearStatus();
      currentWeatherSection.style.display = 'none';
      forecastSection.style.display = 'none';
      currentWeatherDiv.innerHTML = '';
      forecastGrid.innerHTML = '';
      let city = cityInput.value.trim();
      if (city.length < 2) {
        showError('Please enter at least 2 characters for the city name.');
        return;
      }
      if (!/^[a-zA-Z\u00C0-\u017F\s,.'-]+$/.test(city)) {
        showError('Please use only letters, spaces, and common punctuation in the city name.');
        return;
      }
      fetchWeatherForCity(city);
    });

    // Fetch weather data for city
    function fetchWeatherForCity(city) {
      showLoading();
      // 1. Geocode city name to get lat/lon (Open-Meteo Geocoding API)
      fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(city)}&count=1&language=en&format=json`)
        .then(resp => resp.json())
        .then(data => {
          if (!data.results || !data.results.length) {
            throw new Error('City not found. Please check the spelling or try another city.');
          }
          const result = data.results[0];
          const lat = result.latitude;
          const lon = result.longitude;
          const displayName = result.name + (result.country ? ', ' + result.country : '');
          // 2. Fetch weather data (Open-Meteo API)
          fetchWeatherData(lat, lon, displayName);
        })
        .catch(err => {
          clearStatus();
          showError(err.message || 'Unable to find city. Please try again.');
        });
    }

    function fetchWeatherData(lat, lon, displayName) {
      // Open-Meteo API: current + 24h hourly forecast
      // We'll get temperature, weathercode, humidity, windspeed, etc.
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=temperature_2m,weathercode,relativehumidity_2m,windspeed_10m&forecast_days=2&timezone=auto`;
      fetch(url)
        .then(resp => resp.json())
        .then(data => {
          clearStatus();
          if (!data.current_weather || !data.hourly) {
            throw new Error('Weather data not available for this location.');
          }
          displayCurrentWeather(data, displayName);
          displayForecast(data, displayName);
        })
        .catch(err => {
          clearStatus();
          showError(err.message || 'Unable to fetch weather data. Please try again.');
        });
    }

    function displayCurrentWeather(data, displayName) {
      currentWeatherSection.style.display = '';
      const cw = data.current_weather;
      const hourIdx = data.hourly.time.findIndex(t => t === cw.time);
      const humidity = data.hourly.relativehumidity_2m[hourIdx];
      const windspeed = cw.windspeed;
      const code = cw.weathercode;
      const iconData = weatherIcons[code] || { icon: '❔', desc: 'Unknown' };
      const weatherHTML = `
        <div class="weather-icon" aria-hidden="true" title="${iconData.desc}">
          <span style="font-size:3rem;" aria-hidden="true">${iconData.icon}</span>
        </div>
        <div class="weather-info">
          <h3>${displayName}</h3>
          <div class="temperature" aria-label="Current temperature">${Math.round(cw.temperature)}°C</div>
          <div class="condition">${iconData.desc}</div>
          <div class="meta">
            <span title="Humidity"><span class="icon-indicator" aria-hidden="true">💧</span>Humidity: ${humidity}%</span><br>
            <span title="Wind speed"><span class="icon-indicator" aria-hidden="true">💨</span>Wind: ${windspeed} m/s</span>
          </div>
          <div class="meta">
            <span title="Last updated">Updated: ${formatDateTime(cw.time)}</span>
          </div>
        </div>
      `;
      currentWeatherDiv.innerHTML = weatherHTML;
    }

    function displayForecast(data, displayName) {
      forecastSection.style.display = '';
      const now = new Date();
      // Find the index of the next full hour
      let startIdx = data.hourly.time.findIndex(t => new Date(t) > now);
      if (startIdx === -1) startIdx = 0;
      let hours = [];
      for (let i = 0; i < 24; i++) {
        const idx = startIdx + i;
        if (idx >= data.hourly.time.length) break;
        hours.push({
          time: data.hourly.time[idx],
          temp: data.hourly.temperature_2m[idx],
          code: data.hourly.weathercode[idx],
          humidity: data.hourly.relativehumidity_2m[idx],
          wind: data.hourly.windspeed_10m[idx]
        });
      }
      forecastGrid.innerHTML = '';
      hours.forEach(hour => {
        const iconData = weatherIcons[hour.code] || { icon: '❔', desc: 'Unknown' };
        const hourTime = new Date(hour.time);
        const hourLabel = hourTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        const hourCard = document.createElement('div');
        hourCard.className = 'forecast-hour';
        hourCard.setAttribute('tabindex', '0');
        hourCard.setAttribute('role', 'group');
        hourCard.setAttribute('aria-label', `${hourLabel}, ${Math.round(hour.temp)}°C, ${iconData.desc}`);
        hourCard.innerHTML = `
          <div class="hour">${hourLabel}</div>
          <div class="forecast-icon" aria-hidden="true" title="${iconData.desc}">
            <span style="font-size:2rem;" aria-hidden="true">${iconData.icon}</span>
          </div>
          <div class="forecast-temp" aria-label="Temperature">${Math.round(hour.temp)}°C</div>
          <div class="forecast-desc">${iconData.desc}</div>
          <div class="meta" style="font-size:0.93rem;">
            <span title="Humidity"><span class="icon-indicator" aria-hidden="true">💧</span>${hour.humidity}%</span>
            <span title="Wind speed"><span class="icon-indicator" aria-hidden="true">💨</span>${hour.wind} m/s</span>
          </div>
        `;
        forecastGrid.appendChild(hourCard);
      });
    }

    function formatDateTime(dt) {
      const d = new Date(dt);
      return d.toLocaleString([], { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
    }

    // Accessibility: Keyboard navigation for menu (AAA: arrow keys, enter/space, esc)
    document.querySelectorAll('.nav-list [role="menuitem"]').forEach((item, idx, arr) => {
      item.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight') {
          arr[(idx + 1) % arr.length].focus();
          e.preventDefault();
        } else if (e.key === 'ArrowLeft') {
          arr[(idx - 1 + arr.length) % arr.length].focus();
          e.preventDefault();
        }
      });
    });

    // Focus indicator for forecast cards
    forecastGrid && forecastGrid.addEventListener('focusin', function(e) {
      if (e.target.classList.contains('forecast-hour')) {
        e.target.style.boxShadow = '0 0 0 4px var(--focus)';
      }
    });
    forecastGrid && forecastGrid.addEventListener('focusout', function(e) {
      if (e.target.classList.contains('forecast-hour')) {
        e.target.style.boxShadow = 'var(--shadow)';
      }
    });

    // Reduced motion support
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      document.querySelectorAll('.spinner').forEach(spin => spin.style.animation = 'none');
    }

    // Error prevention (AAA: 3.3.6) – Confirm before leaving page with unsaved search
    let formDirty = false;
    cityInput.addEventListener('input', function() {
      formDirty = true;
    });
    window.addEventListener('beforeunload', function(e) {
      if (formDirty) {
        e.preventDefault();
        e.returnValue = 'You have unsaved changes in the search form. Are you sure you want to leave?';
      }
    });

    // Hide error/status on input
    cityInput.addEventListener('input', function() {
      clearError();
      clearStatus();
    });

    // ARIA live region for status updates
    function announce(message) {
      formStatus.setAttribute('aria-live', 'polite');
      formStatus.textContent = message;
      formStatus.style.display = 'block';
    }

    // Dragging alternatives (AAA: 2.5.7) – no drag-and-drop required, all actions via click/tap

    // Pointer cancellation (AAA: up-event only)
    document.querySelectorAll('button, a').forEach(el => {
      el.addEventListener('mousedown', function(e) {
        e.preventDefault();
      });
    });

    // Touch target size enforcement
    document.querySelectorAll('button, a, input[type="color"]').forEach(el => {
      el.style.minWidth = '44px';
      el.style.minHeight = '44px';
    });

    // Modal dialogs not used (no keyboard trap)

    // Ensure all sections have proper heading structure (AAA: 2.4.10)
    // Already covered in markup

    // Fallback: If API fails, show static weather for London
    function fallbackWeather() {
      const data = {
        current_weather: {
          temperature: 18,
          weathercode: 2,
          windspeed: 4,
          time: new Date().toISOString()
        },
        hourly: {
          time: [],
          temperature_2m: [],
          weathercode: [],
          relativehumidity_2m: [],
          windspeed_10m: []
        }
      };
      const now = new Date();
      for (let i = 0; i < 24; i++) {
        const t = new Date(now.getTime() + i * 3600 * 1000);
        data.hourly.time.push(t.toISOString());
        data.hourly.temperature_2m.push(17 + Math.round(Math.random() * 4));
        data.hourly.weathercode.push([2, 3, 1, 0, 61, 80][i % 6]);
        data.hourly.relativehumidity_2m.push(60 + Math.round(Math.random() * 20));
        data.hourly.windspeed_10m.push(2 + Math.round(Math.random() * 3));
      }
      displayCurrentWeather(data, 'London, GB');
      displayForecast(data, 'London, GB');
    }

    // If JS fails to fetch, offer fallback
    form.addEventListener('submit', function(e) {
      setTimeout(function() {
        if (formStatus.textContent.includes('Unable') || formStatus.textContent.includes('not found')) {
          announce('Unable to fetch live weather. Showing example weather for London.');
          fallbackWeather();
        }
      }, 4000);
    });

    // Initial ARIA focus to h1 for screen readers
    window.onload = function() {
      setTimeout(function() {
        document.getElementById('page-title').focus && document.getElementById('page-title').focus();
      }, 200);
    };

    // Hide sections not in view for skip link navigation
    function hashScroll() {
      const id = window.location.hash.replace('#', '');
      if (id) {
        const el = document.getElementById(id);
        if (el) {
          el.scrollIntoView({ behavior: 'smooth', block: 'start' });
          el.focus && el.focus();
        }
      }
    }
    window.addEventListener('hashchange', hashScroll);

    // Ensure form validation on Enter key (for screen readers)
    cityInput.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        form.dispatchEvent(new Event('submit', { cancelable: true, bubbles: true }));
      }
    });
  </script>
</body>
</html>