<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Accessible Interactive Registration Form – WCAG 2.2 AAA Example</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Enhanced contrast, vibrant, accessible color palette; user-selectable colors via CSS variables -->
  <style>
    :root {
      /* User-selectable colors with high contrast */
      --color-bg: #fff;
      --color-fg: #10102b;
      --color-primary: #0068a5;
      --color-secondary: #a81e61;
      --color-accent: #ffb900;
      --color-success: #007a3d;
      --color-error: #b00020;
      --color-info: #26547c;
      --color-focus: #ffb900;
      --color-form-bg: #f6faff;
      --color-border: #1d3557;
      --color-input-bg: #fff;
      --color-input-disabled: #f0f0f0;
      --color-shadow: rgba(38,84,124,0.12);
      --color-link: #0052cc;
      --color-link-visited: #6a1b9a;
      --color-help-bg: #e5f6ff;
      --color-help-border: #0e76a8;
      --color-required: #a81e61;
      --color-valid: #007a3d;
      --color-invalid: #b00020;
      --color-status: #0068a5;
      --color-warning: #e65100;
      --color-highlight: #ffb900;
      --color-breadcrumb-bg: #eaf4ff;
      --color-breadcrumb-current: #0068a5;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --color-bg: #10102b;
        --color-fg: #f6faff;
        --color-form-bg: #232345;
        --color-input-bg: #18183a;
        --color-border: #8ecae6;
        --color-help-bg: #23395d;
        --color-link: #7ad7f0;
        --color-link-visited: #d3aaff;
      }
    }
    html {
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
      min-height: 100%;
      font-size: 18px;
      scroll-behavior: smooth;
    }
    body {
      background: var(--color-bg);
      color: var(--color-fg);
      margin: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      line-height: 1.7;
      min-height: 100vh;
      transition: background 0.2s, color 0.2s;
    }
    header, nav, main, footer, section, aside {
      display: block;
    }
    header {
      background: linear-gradient(90deg, var(--color-primary) 60%, var(--color-secondary) 100%);
      color: var(--color-bg);
      padding: 1.5rem 0 1rem 0;
      text-align: center;
      box-shadow: 0 2px 8px var(--color-shadow);
    }
    header h1 {
      margin: 0 0 0.5rem 0;
      font-size: 2.2rem;
      letter-spacing: 1px;
      font-weight: 700;
      text-shadow: 1px 1px 0 var(--color-border);
    }
    header p {
      margin: 0;
      font-size: 1.15rem;
      font-weight: 400;
      color: #eaf4ff;
    }
    nav[aria-label] {
      background: var(--color-breadcrumb-bg);
      padding: 0.5rem 0;
      border-bottom: 2px solid var(--color-border);
    }
    .breadcrumb {
      margin: 0 auto;
      max-width: 720px;
      padding: 0 1rem;
      font-size: 1rem;
      list-style: none;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
    }
    .breadcrumb li {
      display: flex;
      align-items: center;
    }
    .breadcrumb li:not(:last-child)::after {
      content: "›";
      color: var(--color-secondary);
      margin: 0 0.5em;
      font-weight: bold;
      font-size: 1.1em;
    }
    .breadcrumb a {
      color: var(--color-link);
      text-decoration: underline;
      font-weight: 600;
      transition: color 0.2s;
    }
    .breadcrumb a:focus, .breadcrumb a:hover {
      outline: 2px solid var(--color-focus);
      outline-offset: 2px;
      background: var(--color-highlight);
      color: var(--color-fg);
      border-radius: 6px;
    }
    .breadcrumb .current {
      color: var(--color-breadcrumb-current);
      font-weight: bold;
      pointer-events: none;
      cursor: default;
      text-decoration: none;
    }
    /* Skip Link */
    .skip-link {
      position: absolute;
      left: 8px;
      top: 8px;
      background: var(--color-highlight);
      color: var(--color-fg);
      padding: 0.5em 1em;
      border-radius: 6px;
      z-index: 1000;
      font-weight: 700;
      font-size: 1.05em;
      box-shadow: 0 2px 6px var(--color-shadow);
      transition: transform 0.2s, opacity 0.2s;
      opacity: 0;
      pointer-events: none;
    }
    .skip-link:focus {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
      outline: 3px solid var(--color-focus);
      outline-offset: 2px;
    }
    /* Main Content Layout */
    main {
      display: flex;
      flex-direction: row;
      max-width: 900px;
      margin: 2.5rem auto 2rem auto;
      background: var(--color-form-bg);
      border-radius: 18px;
      box-shadow: 0 4px 24px var(--color-shadow);
      padding: 2.5rem 2rem 2rem 2rem;
      gap: 2.5rem;
      min-height: 540px;
    }
    @media (max-width: 900px) {
      main {
        flex-direction: column;
        padding: 1.2rem 0.6rem;
        gap: 1.2rem;
      }
    }
    /* Sidebar */
    aside {
      flex: 1 1 220px;
      min-width: 220px;
      max-width: 320px;
      background: var(--color-help-bg);
      border: 2px solid var(--color-help-border);
      border-radius: 12px;
      padding: 1.2rem 1rem;
      margin-bottom: 1rem;
      font-size: 1.05rem;
      color: var(--color-fg);
      box-shadow: 0 2px 8px var(--color-shadow);
    }
    aside h2 {
      font-size: 1.2rem;
      margin-top: 0;
      margin-bottom: 0.7em;
      color: var(--color-primary);
    }
    aside ul {
      padding-left: 1.2em;
      margin-top: 0.6em;
      margin-bottom: 0.6em;
    }
    aside li {
      margin-bottom: 0.4em;
    }
    aside abbr[title] {
      border-bottom: 1px dotted var(--color-secondary);
      cursor: help;
      text-decoration: none;
    }
    /* Form Section */
    section[aria-labelledby="form-title"] {
      flex: 2 1 350px;
      min-width: 320px;
      max-width: 540px;
      display: flex;
      flex-direction: column;
    }
    .form-wrapper {
      background: var(--color-input-bg);
      border-radius: 14px;
      padding: 1.5rem 1.2rem;
      box-shadow: 0 2px 12px var(--color-shadow);
      border: 2px solid var(--color-border);
    }
    .form-wrapper h2 {
      margin-top: 0;
      color: var(--color-secondary);
      font-size: 1.4rem;
      margin-bottom: 0.5em;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 1.2em;
    }
    fieldset {
      border: none;
      padding: 0;
      margin: 0;
      min-width: 0;
    }
    legend {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--color-primary);
      margin-bottom: 0.7em;
      padding-left: 0.2em;
    }
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.25em;
      margin-bottom: 0.4em;
      position: relative;
    }
    label {
      font-weight: 600;
      color: var(--color-fg);
      margin-bottom: 0.05em;
      letter-spacing: 0.02em;
      cursor: pointer;
    }
    .required-indicator {
      color: var(--color-required);
      margin-left: 0.25em;
      font-weight: bold;
      font-size: 1.1em;
      vertical-align: middle;
    }
    input[type="text"], input[type="email"], input[type="password"], input[type="tel"] {
      font-size: 1.08em;
      padding: 0.75em 1em;
      border-radius: 8px;
      border: 2px solid var(--color-border);
      background: var(--color-input-bg);
      color: var(--color-fg);
      outline: none;
      box-shadow: none;
      transition: border 0.15s, box-shadow 0.15s;
      min-width: 0;
      width: 100%;
      line-height: 1.4;
      margin-bottom: 0.05em;
      box-sizing: border-box;
      min-height: 44px;
    }
    input:focus {
      border: 2px solid var(--color-focus);
      box-shadow: 0 0 0 3px var(--color-highlight);
      outline: none;
    }
    input[aria-invalid="true"] {
      border-color: var(--color-error);
      background: #fff0f2;
      color: var(--color-error);
    }
    input[aria-invalid="false"]:not(:focus):not(:disabled) {
      border-color: var(--color-valid);
      background: #f0fff4;
      color: var(--color-success);
    }
    input:disabled {
      background: var(--color-input-disabled);
      color: #888;
      cursor: not-allowed;
      border-style: dashed;
    }
    .input-help {
      font-size: 0.99em;
      color: var(--color-info);
      margin-top: 0.12em;
      background: var(--color-help-bg);
      border-left: 4px solid var(--color-help-border);
      padding: 0.2em 0.7em;
      border-radius: 6px;
      margin-bottom: 0.1em;
      max-width: 90%;
    }
    .error-message, .valid-message {
      font-size: 1em;
      margin-top: 0.1em;
      margin-bottom: 0.1em;
      display: flex;
      align-items: center;
      gap: 0.4em;
      min-height: 1.3em;
      line-height: 1.4;
      padding-left: 0.3em;
    }
    .error-message {
      color: var(--color-error);
      background: #fff0f2;
      border-left: 4px solid var(--color-error);
      border-radius: 6px;
      font-weight: 600;
    }
    .valid-message {
      color: var(--color-valid);
      background: #f0fff4;
      border-left: 4px solid var(--color-valid);
      border-radius: 6px;
      font-weight: 600;
    }
    .error-icon,
    .valid-icon {
      font-size: 1.15em;
      display: inline-block;
      width: 1.2em;
      height: 1.2em;
      vertical-align: middle;
      line-height: 1;
    }
    .error-icon {
      color: var(--color-error);
    }
    .valid-icon {
      color: var(--color-valid);
    }
    /* Submission Button */
    .form-actions {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 1.2em;
      margin-top: 0.7em;
    }
    button[type="submit"] {
      font-size: 1.1em;
      font-weight: 700;
      background: linear-gradient(90deg, var(--color-primary) 60%, var(--color-secondary) 100%);
      color: var(--color-bg);
      border: none;
      border-radius: 10px;
      padding: 0.9em 2.2em;
      box-shadow: 0 2px 8px var(--color-shadow);
      cursor: pointer;
      min-width: 44px;
      min-height: 44px;
      outline: none;
      transition: background 0.2s, box-shadow 0.2s, color 0.2s;
      position: relative;
      z-index: 1;
      letter-spacing: 0.03em;
    }
    button[type="submit"]:hover, button[type="submit"]:focus {
      background: linear-gradient(90deg, var(--color-secondary) 60%, var(--color-primary) 100%);
      color: var(--color-bg);
      outline: 3px solid var(--color-focus);
      outline-offset: 2px;
    }
    button[disabled] {
      opacity: 0.7;
      background: #b0b0b0;
      color: #fff;
      cursor: not-allowed;
      box-shadow: none;
    }
    /* Submission Indicator */
    .submission-indicator {
      display: flex;
      align-items: center;
      gap: 0.7em;
      font-size: 1.08em;
      color: var(--color-status);
      min-height: 1.7em;
      margin-top: 0.4em;
    }
    .spinner {
      display: inline-block;
      width: 1.4em;
      height: 1.4em;
      border: 3px solid var(--color-accent);
      border-top: 3px solid var(--color-status);
      border-radius: 50%;
      animation: spin 1.2s linear infinite;
      margin-right: 0.4em;
    }
    @media (prefers-reduced-motion: reduce) {
      .spinner {
        animation: none;
      }
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    /* Submission Success */
    .submission-success {
      color: var(--color-success);
      font-size: 1.13em;
      font-weight: 700;
      background: #f0fff4;
      border-left: 5px solid var(--color-success);
      border-radius: 8px;
      padding: 0.7em 1em;
      margin-top: 1em;
      display: flex;
      align-items: center;
      gap: 0.7em;
    }
    .success-icon {
      font-size: 1.5em;
      color: var(--color-success);
    }
    /* Responsive Enhancements */
    @media (max-width: 700px) {
      main {
        padding: 0.4rem 0.1rem;
      }
      aside {
        min-width: 0;
        max-width: 100%;
      }
      section[aria-labelledby="form-title"] {
        min-width: 0;
        max-width: 100%;
      }
    }
    /* Enhanced Focus Indicator for All Interactive Elements */
    a:focus, button:focus, input:focus, select:focus, textarea:focus {
      outline: 3px solid var(--color-focus) !important;
      outline-offset: 2px !important;
      box-shadow: 0 0 0 4px var(--color-highlight);
      background: #fffbe6;
      color: var(--color-fg);
      z-index: 2;
    }
    /* Utility for visually-hidden (for screen readers only) */
    .sr-only {
      position: absolute !important;
      width: 1px !important;
      height: 1px !important;
      padding: 0 !important;
      margin: -1px !important;
      overflow: hidden !important;
      clip: rect(0, 0, 0, 0) !important;
      border: 0 !important;
      white-space: nowrap !important;
    }
    /* User-selectable colors control */
    .color-controls {
      display: flex;
      gap: 1.2em;
      align-items: center;
      margin: 0.8em 0 0.2em 0;
      font-size: 1em;
      flex-wrap: wrap;
    }
    .color-controls label {
      font-weight: 600;
      color: var(--color-fg);
      margin-right: 0.4em;
    }
    .color-swatch {
      width: 36px;
      height: 36px;
      border-radius: 6px;
      border: 2px solid var(--color-border);
      cursor: pointer;
      margin-right: 0.5em;
      box-shadow: 0 2px 4px var(--color-shadow);
      display: inline-block;
      vertical-align: middle;
      outline: none;
    }
    .color-swatch:focus {
      outline: 3px solid var(--color-focus);
      outline-offset: 2px;
    }
    /* Table for Sitemap */
    .sitemap-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 1em;
      margin-top: 1em;
    }
    .sitemap-table th, .sitemap-table td {
      border: 1px solid var(--color-border);
      padding: 0.6em 0.8em;
      text-align: left;
      background: var(--color-form-bg);
      color: var(--color-fg);
    }
    .sitemap-table th {
      background: var(--color-primary);
      color: var(--color-bg);
      font-weight: 700;
    }
    .sitemap-table tr:focus-within {
      outline: 3px solid var(--color-focus);
      outline-offset: 2px;
    }
    /* Responsive Table */
    @media (max-width: 700px) {
      .sitemap-table, .sitemap-table th, .sitemap-table td {
        font-size: 0.96em;
      }
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link" tabindex="0">Skip to main content</a>
  <header>
    <h1 id="site-title">Accessible Interactive Registration Form</h1>
    <p>
      <strong>Demonstration of a colorful, fully accessible form with real-time validation (WCAG 2.2 AAA compliant).</strong>
    </p>
  </header>
  <nav aria-label="Breadcrumb">
    <ol class="breadcrumb" aria-label="Breadcrumb">
      <li><a href="#site-title">Home</a></li>
      <li><a href="#form-title">Forms</a></li>
      <li class="current" aria-current="page">Registration</li>
    </ol>
  </nav>
  <!-- Multiple ways to locate content: navigation, search, sitemap below -->
  <nav aria-label="Main navigation" style="display:none;">
    <!-- Example: Could contain full site nav if this were a multi-page site -->
  </nav>
  <div class="color-controls" aria-label="Color scheme controls">
    <label for="fg-color-picker">Text color:</label>
    <input id="fg-color-picker" type="color" aria-label="Select text color" class="color-swatch" value="#10102b" tabindex="0">
    <label for="bg-color-picker">Background color:</label>
    <input id="bg-color-picker" type="color" aria-label="Select background color" class="color-swatch" value="#ffffff" tabindex="0">
  </div>
  <main id="main-content" tabindex="-1">
    <aside aria-labelledby="help-title">
      <h2 id="help-title">Form Guidance &amp; Help</h2>
      <p>
        <strong>How to complete the form:</strong>
      </p>
      <ul>
        <li>
          All <span class="required-indicator" aria-hidden="true">*</span> fields are <strong>required</strong>.
        </li>
        <li>
          <strong>Name:</strong> Enter your full name (letters, spaces, and hyphens only).
        </li>
        <li>
          <strong>Email:</strong> Use a valid email address (e.g., <em>alex@example.com</em>).
        </li>
        <li>
          <strong>Password:</strong> Minimum 8 characters, including a number, uppercase, lowercase, and symbol.
        </li>
        <li>
          <strong>Phone:</strong> Enter a valid phone number. Format: <em>(123) 456-7890</em> or <em>+1 234-567-8901</em>.
        </li>
      </ul>
      <p>
        <strong>Accessibility Features:</strong>
        <ul>
          <li>Enhanced color contrast and large touch targets</li>
          <li>Keyboard and screen reader support</li>
          <li>Clear error messages and validation feedback</li>
        </ul>
      </p>
      <p>
        <strong>Abbreviations:</strong> <abbr title="World Wide Web Consortium">W3C</abbr>, <abbr title="Web Content Accessibility Guidelines">WCAG</abbr>
      </p>
      <p>
        <strong>Reading Level:</strong> This help is written at a lower secondary education level. If you need a simpler explanation, <a href="#simple-help" id="simple-help-link">click here for a simplified version</a>.
      </p>
      <div id="simple-help" class="sr-only" aria-live="polite">
        <strong>Simplified Help:</strong>
        <ul>
          <li>Fill in all the boxes with your information.</li>
          <li>Use your real email and phone number.</li>
          <li>Pick a strong password you can remember.</li>
        </ul>
      </div>
    </aside>
    <section aria-labelledby="form-title">
      <div class="form-wrapper" role="form" aria-labelledby="form-title">
        <h2 id="form-title">Registration Form</h2>
        <form id="registration-form" novalidate autocomplete="on" aria-describedby="form-help" spellcheck="false">
          <fieldset>
            <legend>Personal Information</legend>
            <div class="form-group">
              <label for="name" id="label-name">
                Name <span class="required-indicator" aria-hidden="true">*</span>
              </label>
              <input
                id="name"
                name="name"
                type="text"
                required
                aria-required="true"
                aria-describedby="name-help name-error"
                aria-invalid="false"
                autocomplete="name"
                minlength="2"
                maxlength="50"
                pattern="^[A-Za-zÀ-ÿ' -]+$"
                inputmode="text"
                spellcheck="false"
              >
              <div id="name-help" class="input-help">
                Enter your full name (letters, spaces, hyphens only).
              </div>
              <div id="name-error" class="error-message" aria-live="polite"></div>
            </div>
            <div class="form-group">
              <label for="email" id="label-email">
                Email <span class="required-indicator" aria-hidden="true">*</span>
              </label>
              <input
                id="email"
                name="email"
                type="email"
                required
                aria-required="true"
                aria-describedby="email-help email-error"
                aria-invalid="false"
                autocomplete="email"
                inputmode="email"
                spellcheck="false"
              >
              <div id="email-help" class="input-help">
                Example: <kbd>alex@example.com</kbd>
              </div>
              <div id="email-error" class="error-message" aria-live="polite"></div>
            </div>
            <div class="form-group">
              <label for="password" id="label-password">
                Password <span class="required-indicator" aria-hidden="true">*</span>
              </label>
              <input
                id="password"
                name="password"
                type="password"
                required
                aria-required="true"
                aria-describedby="password-help password-error"
                aria-invalid="false"
                autocomplete="new-password"
                minlength="8"
                maxlength="64"
                inputmode="text"
                spellcheck="false"
              >
              <div id="password-help" class="input-help">
                Minimum 8 characters, at least one uppercase, one lowercase, one number, and one symbol.
              </div>
              <div id="password-error" class="error-message" aria-live="polite"></div>
            </div>
            <div class="form-group">
              <label for="phone" id="label-phone">
                Phone Number <span class="required-indicator" aria-hidden="true">*</span>
              </label>
              <input
                id="phone"
                name="phone"
                type="tel"
                required
                aria-required="true"
                aria-describedby="phone-help phone-error"
                aria-invalid="false"
                autocomplete="tel"
                inputmode="tel"
                minlength="8"
                maxlength="20"
                pattern="^(\+?\d{1,3}[-.\s]?)?(\(?\d{3}\)?[-.\s]?)?\d{3}[-.\s]?\d{4,6}$"
                spellcheck="false"
              >
              <div id="phone-help" class="input-help">
                Format: <kbd>(123) 456-7890</kbd> or <kbd>+1 234-567-8901</kbd>
              </div>
              <div id="phone-error" class="error-message" aria-live="polite"></div>
            </div>
          </fieldset>
          <div class="form-actions">
            <button type="submit" id="submit-btn" aria-label="Submit registration form">
              Register
            </button>
            <div id="submission-indicator" class="submission-indicator" aria-live="polite" role="status"></div>
          </div>
        </form>
        <div id="submission-success" class="submission-success" role="status" aria-live="polite" style="display:none;">
          <span class="success-icon" aria-hidden="true">✔️</span>
          Registration successful! Thank you for signing up.
        </div>
      </div>
      <div id="form-help" class="input-help" style="margin-top:1.2em;">
        <strong>Need help?</strong> <a href="#help-title">See the help section on the left</a>.
      </div>
      <nav aria-label="Page Sitemap" style="margin-top:2.5em;">
        <h3 id="sitemap-title">Sitemap</h3>
        <table class="sitemap-table" aria-describedby="sitemap-desc">
          <caption id="sitemap-desc" class="sr-only">Table listing sections and navigation for this page.</caption>
          <thead>
            <tr>
              <th scope="col">Section</th>
              <th scope="col">Purpose</th>
              <th scope="col">Link</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Home</td>
              <td>Go to top of page</td>
              <td><a href="#site-title">Home</a></td>
            </tr>
            <tr>
              <td>Form Help</td>
              <td>Instructions and guidance</td>
              <td><a href="#help-title">Help</a></td>
            </tr>
            <tr>
              <td>Registration Form</td>
              <td>Fill out and submit form</td>
              <td><a href="#form-title">Form</a></td>
            </tr>
            <tr>
              <td>Sitemap</td>
              <td>Page navigation overview</td>
              <td><a href="#sitemap-title">Sitemap</a></td>
            </tr>
          </tbody>
        </table>
      </nav>
    </section>
  </main>
  <footer>
    <section aria-labelledby="footer-title" style="background: linear-gradient(90deg, var(--color-secondary) 60%, var(--color-primary) 100%); color: var(--color-bg); padding: 1.5rem 0 1.2rem 0; text-align: center;">
      <h2 id="footer-title" class="sr-only">Footer</h2>
      <p>
        <strong>Accessible Registration Form Example</strong> &mdash; <span lang="fr" title="French">Exemple de formulaire accessible</span>
      </p>
      <p>
        <a href="#site-title" style="color: var(--color-accent); text-decoration: underline;">Back to top</a>
        &nbsp;|&nbsp;
        <a href="#form-title" style="color: var(--color-accent); text-decoration: underline;">Go to form</a>
      </p>
      <p style="font-size: 0.98em;">
        <abbr title="Web Content Accessibility Guidelines">WCAG</abbr> 2.2 AAA Demonstration &copy; 2024
      </p>
    </section>
  </footer>
  <script>
    // Utility: Color picker for user-selectable foreground/background
    function setColorScheme(fg, bg) {
      document.documentElement.style.setProperty('--color-fg', fg);
      document.documentElement.style.setProperty('--color-bg', bg);
    }
    const fgPicker = document.getElementById('fg-color-picker');
    const bgPicker = document.getElementById('bg-color-picker');
    fgPicker.addEventListener('input', function() {
      setColorScheme(fgPicker.value, bgPicker.value);
    });
    bgPicker.addEventListener('input', function() {
      setColorScheme(fgPicker.value, bgPicker.value);
    });

    // Focus management for skip link
    document.querySelector('.skip-link').addEventListener('click', function(e) {
      document.getElementById('main-content').focus();
    });

    // Simple help toggle for cognitive accessibility
    document.getElementById('simple-help-link').addEventListener('click', function(e) {
      e.preventDefault();
      const simpleHelp = document.getElementById('simple-help');
      if (simpleHelp.classList.contains('sr-only')) {
        simpleHelp.classList.remove('sr-only');
        simpleHelp.setAttribute('tabindex', '-1');
        simpleHelp.focus();
      } else {
        simpleHelp.classList.add('sr-only');
      }
    });

    // Form validation logic
    const form = document.getElementById('registration-form');
    const fields = {
      name: {
        input: document.getElementById('name'),
        error: document.getElementById('name-error'),
        help: document.getElementById('name-help'),
        validate: value => {
          if (!value.trim()) return 'Name is required.';
          if (value.length < 2) return 'Name must be at least 2 characters.';
          if (!/^[A-Za-zÀ-ÿ' -]+$/.test(value)) return 'Name may only contain letters, spaces, apostrophes, or hyphens.';
          return '';
        }
      },
      email: {
        input: document.getElementById('email'),
        error: document.getElementById('email-error'),
        help: document.getElementById('email-help'),
        validate: value => {
          if (!value.trim()) return 'Email is required.';
          // Simple email regex, not exhaustive but accessible
          if (!/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(value)) return 'Enter a valid email address (e.g., alex@example.com).';
          return '';
        }
      },
      password: {
        input: document.getElementById('password'),
        error: document.getElementById('password-error'),
        help: document.getElementById('password-help'),
        validate: value => {
          if (!value) return 'Password is required.';
          if (value.length < 8) return 'Password must be at least 8 characters.';
          if (!/[A-Z]/.test(value)) return 'Include at least one uppercase letter.';
          if (!/[a-z]/.test(value)) return 'Include at least one lowercase letter.';
          if (!/[0-9]/.test(value)) return 'Include at least one number.';
          if (!/[^A-Za-z0-9]/.test(value)) return 'Include at least one symbol (e.g., !@#$%).';
          return '';
        }
      },
      phone: {
        input: document.getElementById('phone'),
        error: document.getElementById('phone-error'),
        help: document.getElementById('phone-help'),
        validate: value => {
          if (!value.trim()) return 'Phone number is required.';
          // Accepts (123) 456-7890, 123-456-7890, +1 234-567-8901, etc.
          if (!/^(\+?\d{1,3}[-.\s]?)?(\(?\d{3}\)?[-.\s]?)?\d{3}[-.\s]?\d{4,6}$/.test(value)) return 'Enter a valid phone number (e.g., (123) 456-7890).';
          return '';
        }
      }
    };

    // Helper: Show error or valid message
    function showFieldFeedback(field, errorMsg) {
      if (errorMsg) {
        field.input.setAttribute('aria-invalid', 'true');
        field.error.innerHTML = `<span class="error-icon" aria-hidden="true">⚠️</span> ${errorMsg}`;
        field.input.classList.remove('valid');
        field.input.classList.add('invalid');
        field.input.setAttribute('aria-describedby', field.help.id + ' ' + field.error.id);
      } else {
        field.input.setAttribute('aria-invalid', 'false');
        field.error.innerHTML = `<span class="valid-icon" aria-hidden="true">✔️</span> Looks good.`;
        field.input.classList.remove('invalid');
        field.input.classList.add('valid');
        field.input.setAttribute('aria-describedby', field.help.id + ' ' + field.error.id);
      }
    }

    // Real-time validation
    Object.values(fields).forEach(field => {
      field.input.addEventListener('input', function() {
        const errorMsg = field.validate(field.input.value);
        showFieldFeedback(field, errorMsg);
      });
      field.input.addEventListener('blur', function() {
        const errorMsg = field.validate(field.input.value);
        showFieldFeedback(field, errorMsg);
      });
    });

    // Enhanced keyboard accessibility for help links and color pickers
    document.querySelectorAll('.color-swatch').forEach(swatch => {
      swatch.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          swatch.click();
        }
      });
    });

    // Submission indicator and success message
    const submitBtn = document.getElementById('submit-btn');
    const submissionIndicator = document.getElementById('submission-indicator');
    const submissionSuccess = document.getElementById('submission-success');

    // Error prevention: Confirm before submit, show summary if errors
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      let hasError = false;
      let firstErrorField = null;
      Object.values(fields).forEach(field => {
        const errorMsg = field.validate(field.input.value);
        showFieldFeedback(field, errorMsg);
        if (errorMsg && !hasError) {
          hasError = true;
          firstErrorField = field.input;
        }
      });
      if (hasError) {
        // Move focus to first error
        firstErrorField.focus();
        submissionIndicator.innerHTML = `<span class="error-icon" aria-hidden="true">⚠️</span> Please correct the errors above.`;
        return;
      }
      // Confirmation dialog (AAA error prevention)
      if (!window.confirm('Do you want to submit the form with the entered information?')) {
        submissionIndicator.innerHTML = `<span class="error-icon" aria-hidden="true">⚠️</span> Submission cancelled.`;
        return;
      }
      // Simulate submission
      submitBtn.disabled = true;
      submissionIndicator.innerHTML = `<span class="spinner" aria-hidden="true"></span> Submitting...`;
      // Announce loading state
      submissionIndicator.setAttribute('aria-live', 'assertive');
      setTimeout(function() {
        submitBtn.disabled = false;
        submissionIndicator.innerHTML = '';
        submissionSuccess.style.display = 'flex';
        submissionSuccess.focus();
        // Reset form after short delay
        setTimeout(function() {
          form.reset();
          Object.values(fields).forEach(field => {
            field.input.setAttribute('aria-invalid', 'false');
            field.error.innerHTML = '';
            field.input.classList.remove('valid', 'invalid');
          });
          submissionSuccess.style.display = 'none';
        }, 4500);
      }, 1800);
    });

    // Touch target fix: Enlarge input and button clickable area
    function ensureTouchTargets() {
      // All inputs and buttons already min-height:44px via CSS
      // But we can add role="button" for color swatches for screen readers
      document.querySelectorAll('.color-swatch').forEach(swatch => {
        swatch.setAttribute('role', 'button');
        swatch.setAttribute('tabindex', '0');
      });
    }
    ensureTouchTargets();

    // Responsive design: handle zoom and width
    function checkZoom() {
      document.body.style.maxWidth = '100vw';
      document.body.style.overflowX = 'auto';
    }
    checkZoom();

    // Reduced motion: Only animate spinner if allowed
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      document.querySelectorAll('.spinner').forEach(spinner => {
        spinner.style.animation = 'none';
      });
    }
  </script>
</body>
</html>